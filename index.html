<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chòm sao Ma Kết</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: black;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r148/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script>
    // Scene setup
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    camera.position.z = 30;

    const renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Background stars
    const starsGeometry = new THREE.BufferGeometry();
    const starCount = 1000;
    const starVertices = [];
    for (let i = 0; i < starCount; i++) {
      starVertices.push((Math.random() - 0.5) * 100);
      starVertices.push((Math.random() - 0.5) * 100);
      starVertices.push((Math.random() - 0.5) * 100);
    }
    starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
    const starsMaterial = new THREE.PointsMaterial({ color: 0xffffff });
    const starField = new THREE.Points(starsGeometry, starsMaterial);
    scene.add(starField);

    // Capricorn constellation points
    const capricornPoints = [
      [0, 0, 0],
      [2, 3, 0],
      [5, 5, 0],
      [7, 2, 0],
      [6, -2, 0],
      [3, -3, 0],
      [-1, -2, 0],
      [-3, -1, 0],
    ];

    const starMeshes = [];
    const starMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });
    const starGeometry = new THREE.SphereGeometry(0.2, 12, 12);

    capricornPoints.forEach((pos, i) => {
      const mesh = new THREE.Mesh(starGeometry, starMaterial.clone());
      mesh.position.set(...pos);
      mesh.material.transparent = true;
      mesh.material.opacity = 0;
      scene.add(mesh);
      starMeshes.push(mesh);
      gsap.to(mesh.material, {
        opacity: 1,
        duration: 1,
        delay: i * 0.5
      });
    });

    // Connect stars with lines
    const lines = [
      [0,1], [1,2], [2,3], [3,4], [4,5], [5,6], [6,7]
    ];

    setTimeout(() => {
      lines.forEach(([a, b], i) => {
        const material = new THREE.LineBasicMaterial({ color: 0x66ccff });
        const geometry = new THREE.BufferGeometry().setFromPoints([
          new THREE.Vector3(...capricornPoints[a]),
          new THREE.Vector3(...capricornPoints[b])
        ]);
        const line = new THREE.Line(geometry, material);
        line.material.transparent = true;
        line.material.opacity = 0;
        scene.add(line);
        gsap.to(line.material, {
          opacity: 1,
          duration: 1,
          delay: i * 0.5
        });
      });
    }, capricornPoints.length * 500);

    // Animate scene
    function animate() {
      requestAnimationFrame(animate);
      starField.rotation.y += 0.0005;
      renderer.render(scene, camera);
    }
    animate();

    // Handle resize
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
